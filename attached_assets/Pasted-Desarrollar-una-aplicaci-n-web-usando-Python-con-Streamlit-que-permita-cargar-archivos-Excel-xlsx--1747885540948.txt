Desarrollar una aplicaciÃ³n web usando Python con Streamlit que permita cargar archivos Excel (.xlsx y .xlsm) con datos operacionales. Desde la hoja llamada â€œBase de Datosâ€, la app debe generar informes basados en una fecha seleccionada por el usuario desde un calendario. Luego, debe crear dashboards interactivos, realizar un anÃ¡lisis automÃ¡tico con inteligencia artificial, y permitir guardar los informes para poder consultarlos despuÃ©s solo seleccionando la fecha.

â¸»

ğŸ”§ Requisitos tÃ©cnicos
	â€¢	Lenguaje: Python 3.10 o superior
	â€¢	Framework: Streamlit
	â€¢	Procesamiento de Excel: pandas, openpyxl, xlrd
	â€¢	VisualizaciÃ³n: plotly, altair, matplotlib, seaborn
	â€¢	ExportaciÃ³n: xlsxwriter para Excel y pdfkit o weasyprint para PDF
	â€¢	Persistencia: Guardado local de informes (como .json, .pkl, .xlsx o .csv) en carpetas por fecha
	â€¢	IA/NLP: Motor de anÃ¡lisis automÃ¡tico (reglas bÃ¡sicas o integraciÃ³n con OpenAI)

â¸»

âœ… Funcionalidades requeridas

1. Carga de archivos Excel
	â€¢	El usuario sube archivos .xlsx o .xlsm.
	â€¢	Validar que exista la hoja â€œBase de Datosâ€.
	â€¢	Leer datos preservando fechas, fÃ³rmulas y tipos.

2. SelecciÃ³n de fecha
	â€¢	Usar un calendario (st.date_input) para seleccionar una fecha o rango.
	â€¢	Filtrar automÃ¡ticamente los datos segÃºn esa fecha.

3. GeneraciÃ³n de informe
	â€¢	Generar mÃ©tricas clave (totales, promedios, mÃ¡ximos, etc.).
	â€¢	Comparaciones con periodos anteriores si estÃ¡n disponibles.
	â€¢	Mostrar en st.dataframe con opciÃ³n de exportar a Excel o PDF.

4. Dashboard visual interactivo
	â€¢	Filtros desplegables en tiempo real (por proceso, zona, turno, equipo, etc.).
	â€¢	Visualizaciones comparativas entre fechas seleccionadas.
	â€¢	Posibilidad de â€œanclarâ€ mÃ©tricas clave para tenerlas siempre visibles.
	â€¢	GrÃ¡ficos interactivos construidos con plotly, altair o similar.

5. AnÃ¡lisis automÃ¡tico con IA
	â€¢	Generar un resumen en lenguaje natural con observaciones clave:
	â€¢	Tendencias
	â€¢	AnomalÃ­as
	â€¢	Variaciones importantes
	â€¢	Ejemplo de salida:
â€œLa producciÃ³n disminuyÃ³ un 12% respecto a la semana pasada, especialmente en el turno noche del Ã¡rea norte.â€

6. Guardado de informes
	â€¢	BotÃ³n â€œGuardar informeâ€ que:
	â€¢	Almacena el informe generado, el anÃ¡lisis IA y las visualizaciones en una carpeta estructurada por fecha (/informes/AAAA-MM-DD/)
	â€¢	Guarda en formato .pkl, .xlsx, .json, o equivalente.

7. Consulta de informes guardados
	â€¢	Mostrar calendario o lista de fechas con informes guardados.
	â€¢	Al seleccionar una, mostrar automÃ¡ticamente el informe, dashboard y anÃ¡lisis que corresponden a esa fecha.

â¸»

ğŸ“Š Dashboards mÃ¡s dinÃ¡micos
	â€¢	Filtros desplegables en tiempo real: por proceso, zona, turno, equipo, etc.
	â€¢	Visualizaciones comparativas entre fechas: comparar producciÃ³n o mÃ©tricas clave entre dos rangos seleccionados.
	â€¢	Anclar mÃ©tricas clave: el usuario puede marcar variables importantes para que se muestren permanentemente (como KPIs).

â¸»

ğŸ§© Modularidad del cÃ³digo (estructura recomendada)

Separar responsabilidades del sistema en mÃ³dulos distintos para mejorar mantenibilidad y escalabilidad:

ğŸ“ app/
â”œâ”€â”€ app.py                        # LÃ³gica principal y flujo de Streamlit
â”œâ”€â”€ ğŸ“ components/
â”‚   â”œâ”€â”€ file_uploader.py         # Carga de archivos Excel
â”‚   â”œâ”€â”€ report_generator.py      # LÃ³gica del informe
â”‚   â”œâ”€â”€ dashboard.py             # Visualizaciones
â”‚   â”œâ”€â”€ ai_analysis.py           # AnÃ¡lisis automatizado con IA
â”‚   â”œâ”€â”€ data_filter.py           # Filtro por fecha y otros campos
â”‚   â”œâ”€â”€ report_storage.py        # Guardado y carga de informes
â”œâ”€â”€ ğŸ“ data/
â”‚   â”œâ”€â”€ raw/                     # Archivos Excel originales
â”‚   â”œâ”€â”€ processed/               # Informes generados por fecha
â”œâ”€â”€ ğŸ“ assets/                   # Logo, estilos o imÃ¡genes si se usan

Esta estructura evita tener todo en un solo app.py y facilita agregar nuevas funcionalidades a futuro sin romper lo existente.

â¸»

ğŸ§­ Flujo de usuario
	1.	Usuario carga un archivo Excel.
	2.	Selecciona una fecha desde el calendario.
	3.	La app filtra y genera el informe + dashboard.
	4.	La IA analiza y comenta los resultados.
	5.	El usuario guarda el informe.
	6.	En otra sesiÃ³n, selecciona la fecha deseada y recupera todo sin volver a cargar archivos